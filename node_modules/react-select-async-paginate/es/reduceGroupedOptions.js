import _toConsumableArray from "@babel/runtime/helpers/toConsumableArray";
import _objectSpread from "@babel/runtime/helpers/objectSpread2";
export var checkGroup = function checkGroup(group) {
  if (!group) {
    return false;
  }

  var _ref = group,
      label = _ref.label,
      options = _ref.options;

  if (typeof label !== 'string' && typeof label !== 'undefined') {
    return false;
  }

  if (!Array.isArray(options)) {
    return false;
  }

  return true;
};
export var reduceGroupedOptions = function reduceGroupedOptions(prevOptions, loadedOptions) {
  var res = prevOptions.slice();
  var mapLabelToIndex = {};
  var prevOptionsIndex = 0;
  var prevOptionsLength = prevOptions.length;
  loadedOptions.forEach(function (optionOrGroup) {
    var group = checkGroup(optionOrGroup) ? optionOrGroup : {
      options: [optionOrGroup]
    };
    var _group$label = group.label,
        label = _group$label === void 0 ? '' : _group$label;
    var groupIndex = mapLabelToIndex[label];

    if (typeof groupIndex !== 'number') {
      for (; prevOptionsIndex < prevOptionsLength && typeof mapLabelToIndex[label] !== 'number'; ++prevOptionsIndex) {
        var prevGroup = prevOptions[prevOptionsIndex];

        if (checkGroup(prevGroup)) {
          mapLabelToIndex[prevGroup.label || ''] = prevOptionsIndex;
        }
      }

      groupIndex = mapLabelToIndex[label];
    }

    if (typeof groupIndex !== 'number') {
      mapLabelToIndex[label] = res.length;
      res.push(group);
      return;
    }

    res[groupIndex] = _objectSpread(_objectSpread({}, res[groupIndex]), {}, {
      options: [].concat(_toConsumableArray(res[groupIndex].options), _toConsumableArray(group.options))
    });
  });
  return res;
};